<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Regression Textbook Supplement - 8&nbsp; Independence</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./chapter7.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter8.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Regression Textbook Supplement</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simple Linear Regression Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple Linear Regression Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Goodness of Fit</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Comparing Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Indicator Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#required-packages" id="toc-required-packages" class="nav-link active" data-scroll-target="#required-packages"><span class="header-section-number">8.1</span> Required packages</a></li>
  <li><a href="#page-140-independencedependence-with-means" id="toc-page-140-independencedependence-with-means" class="nav-link" data-scroll-target="#page-140-independencedependence-with-means"><span class="header-section-number">8.2</span> Page 140 Independence/Dependence with Means</a>
  <ul>
  <li><a href="#obtain-data-and-save-it-to-your-computer" id="toc-obtain-data-and-save-it-to-your-computer" class="nav-link" data-scroll-target="#obtain-data-and-save-it-to-your-computer"><span class="header-section-number">8.2.1</span> Obtain data and save it to your computer</a></li>
  <li><a href="#load-data-from-your-computer" id="toc-load-data-from-your-computer" class="nav-link" data-scroll-target="#load-data-from-your-computer"><span class="header-section-number">8.2.2</span> Load data from your computer</a></li>
  <li><a href="#inspect-data" id="toc-inspect-data" class="nav-link" data-scroll-target="#inspect-data"><span class="header-section-number">8.2.3</span> Inspect data</a></li>
  <li><a href="#view-data" id="toc-view-data" class="nav-link" data-scroll-target="#view-data"><span class="header-section-number">8.2.4</span> View data</a></li>
  <li><a href="#specify-design" id="toc-specify-design" class="nav-link" data-scroll-target="#specify-design"><span class="header-section-number">8.2.5</span> Specify Design</a></li>
  <li><a href="#calculate-meanse" id="toc-calculate-meanse" class="nav-link" data-scroll-target="#calculate-meanse"><span class="header-section-number">8.2.6</span> Calculate Mean/SE</a></li>
  <li><a href="#calculate-meanse-incorporting-cluster-dependence" id="toc-calculate-meanse-incorporting-cluster-dependence" class="nav-link" data-scroll-target="#calculate-meanse-incorporting-cluster-dependence"><span class="header-section-number">8.2.7</span> Calculate Mean/SE Incorporting Cluster Dependence</a></li>
  </ul></li>
  <li><a href="#page-142-independencedependence-with-regression" id="toc-page-142-independencedependence-with-regression" class="nav-link" data-scroll-target="#page-142-independencedependence-with-regression"><span class="header-section-number">8.3</span> Page 142 Independence/Dependence with Regression</a>
  <ul>
  <li><a href="#regular-regression-no-adjustment" id="toc-regular-regression-no-adjustment" class="nav-link" data-scroll-target="#regular-regression-no-adjustment"><span class="header-section-number">8.3.1</span> Regular Regression No Adjustment</a></li>
  <li><a href="#dependence-adjusted-regression" id="toc-dependence-adjusted-regression" class="nav-link" data-scroll-target="#dependence-adjusted-regression"><span class="header-section-number">8.3.2</span> Dependence Adjusted Regression</a></li>
  <li><a href="#comparing-results" id="toc-comparing-results" class="nav-link" data-scroll-target="#comparing-results"><span class="header-section-number">8.3.3</span> Comparing results</a>
  <ul>
  <li><a href="#regular-regression---see-se-for-weights" id="toc-regular-regression---see-se-for-weights" class="nav-link" data-scroll-target="#regular-regression---see-se-for-weights"><span class="header-section-number">8.3.3.1</span> Regular regression - see SE for weights</a></li>
  <li><a href="#dependence-adjusted---see-se-for-weights" id="toc-dependence-adjusted---see-se-for-weights" class="nav-link" data-scroll-target="#dependence-adjusted---see-se-for-weights"><span class="header-section-number">8.3.3.2</span> Dependence Adjusted - see SE for weights</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#page-145-serial-correlation" id="toc-page-145-serial-correlation" class="nav-link" data-scroll-target="#page-145-serial-correlation"><span class="header-section-number">8.4</span> Page 145 Serial Correlation</a>
  <ul>
  <li><a href="#obtain-data-and-save-it-to-your-computer-1" id="toc-obtain-data-and-save-it-to-your-computer-1" class="nav-link" data-scroll-target="#obtain-data-and-save-it-to-your-computer-1"><span class="header-section-number">8.4.1</span> Obtain data and save it to your computer</a></li>
  <li><a href="#load-data-from-your-computer-1" id="toc-load-data-from-your-computer-1" class="nav-link" data-scroll-target="#load-data-from-your-computer-1"><span class="header-section-number">8.4.2</span> Load data from your computer</a></li>
  <li><a href="#inspect-data-1" id="toc-inspect-data-1" class="nav-link" data-scroll-target="#inspect-data-1"><span class="header-section-number">8.4.3</span> Inspect data</a></li>
  <li><a href="#view-data-1" id="toc-view-data-1" class="nav-link" data-scroll-target="#view-data-1"><span class="header-section-number">8.4.4</span> View data</a></li>
  <li><a href="#regular-regression" id="toc-regular-regression" class="nav-link" data-scroll-target="#regular-regression"><span class="header-section-number">8.4.5</span> Regular Regression</a>
  <ul>
  <li><a href="#check-autocorrelation-of-residuals" id="toc-check-autocorrelation-of-residuals" class="nav-link" data-scroll-target="#check-autocorrelation-of-residuals"><span class="header-section-number">8.4.5.1</span> Check Autocorrelation of Residuals</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#page-150-corrections-for-dependence" id="toc-page-150-corrections-for-dependence" class="nav-link" data-scroll-target="#page-150-corrections-for-dependence"><span class="header-section-number">8.5</span> Page 150 Corrections for dependence</a>
  <ul>
  <li><a href="#regular-regression-1" id="toc-regular-regression-1" class="nav-link" data-scroll-target="#regular-regression-1"><span class="header-section-number">8.5.1</span> Regular regression</a></li>
  <li><a href="#page-prais-winsten-regression-model" id="toc-page-prais-winsten-regression-model" class="nav-link" data-scroll-target="#page-prais-winsten-regression-model"><span class="header-section-number">8.5.2</span> Page Prais-Winsten Regression Model</a></li>
  </ul></li>
  <li><a href="#page-153-gee-for-longitudinal-data" id="toc-page-153-gee-for-longitudinal-data" class="nav-link" data-scroll-target="#page-153-gee-for-longitudinal-data"><span class="header-section-number">8.6</span> Page 153 GEE for Longitudinal Data</a>
  <ul>
  <li><a href="#obtain-data-and-save-it-to-your-computer-2" id="toc-obtain-data-and-save-it-to-your-computer-2" class="nav-link" data-scroll-target="#obtain-data-and-save-it-to-your-computer-2"><span class="header-section-number">8.6.1</span> Obtain data and save it to your computer</a></li>
  <li><a href="#load-data-from-your-computer-2" id="toc-load-data-from-your-computer-2" class="nav-link" data-scroll-target="#load-data-from-your-computer-2"><span class="header-section-number">8.6.2</span> Load data from your computer</a></li>
  <li><a href="#inspect-data-2" id="toc-inspect-data-2" class="nav-link" data-scroll-target="#inspect-data-2"><span class="header-section-number">8.6.3</span> Inspect data</a></li>
  <li><a href="#view-data-2" id="toc-view-data-2" class="nav-link" data-scroll-target="#view-data-2"><span class="header-section-number">8.6.4</span> View data</a></li>
  <li><a href="#just-essential-variables" id="toc-just-essential-variables" class="nav-link" data-scroll-target="#just-essential-variables"><span class="header-section-number">8.6.5</span> Just essential variables</a></li>
  <li><a href="#regular-regression-2" id="toc-regular-regression-2" class="nav-link" data-scroll-target="#regular-regression-2"><span class="header-section-number">8.6.6</span> Regular Regression</a></li>
  </ul></li>
  <li><a href="#page-154-gee-regression-ar1-pattern" id="toc-page-154-gee-regression-ar1-pattern" class="nav-link" data-scroll-target="#page-154-gee-regression-ar1-pattern"><span class="header-section-number">8.7</span> Page 154 GEE Regression AR(1) Pattern</a></li>
  <li><a href="#page-155-gee-regression-unstructured-pattern" id="toc-page-155-gee-regression-unstructured-pattern" class="nav-link" data-scroll-target="#page-155-gee-regression-unstructured-pattern"><span class="header-section-number">8.8</span> Page 155 GEE Regression Unstructured Pattern</a></li>
  <li><a href="#page-157-lagged-regression" id="toc-page-157-lagged-regression" class="nav-link" data-scroll-target="#page-157-lagged-regression"><span class="header-section-number">8.9</span> Page 157 Lagged Regression</a>
  <ul>
  <li><a href="#regression-with-lagged-scores" id="toc-regression-with-lagged-scores" class="nav-link" data-scroll-target="#regression-with-lagged-scores"><span class="header-section-number">8.9.1</span> Regression with lagged scores</a></li>
  </ul></li>
  <li><a href="#page-162-chapter-exercises" id="toc-page-162-chapter-exercises" class="nav-link" data-scroll-target="#page-162-chapter-exercises"><span class="header-section-number">8.10</span> Page 162 Chapter Exercises</a>
  <ul>
  <li><a href="#obtain-data-and-save-it-to-your-computer-3" id="toc-obtain-data-and-save-it-to-your-computer-3" class="nav-link" data-scroll-target="#obtain-data-and-save-it-to-your-computer-3"><span class="header-section-number">8.10.1</span> Obtain data and save it to your computer</a></li>
  <li><a href="#load-data-from-your-computer-3" id="toc-load-data-from-your-computer-3" class="nav-link" data-scroll-target="#load-data-from-your-computer-3"><span class="header-section-number">8.10.2</span> Load data from your computer</a></li>
  <li><a href="#inspect-data-3" id="toc-inspect-data-3" class="nav-link" data-scroll-target="#inspect-data-3"><span class="header-section-number">8.10.3</span> Inspect data</a></li>
  <li><a href="#view-data-3" id="toc-view-data-3" class="nav-link" data-scroll-target="#view-data-3"><span class="header-section-number">8.10.4</span> View data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="required-packages" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="required-packages"><span class="header-section-number">8.1</span> Required packages</h2>
<p>The following CRAN packages must be installed:</p>
<table class="table">
<thead>
<tr class="header">
<th>Required CRAN Packages</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>tidyverse</td>
</tr>
<tr class="even">
<td>usethis</td>
</tr>
<tr class="odd">
<td>janitor</td>
</tr>
<tr class="even">
<td>skimr</td>
</tr>
<tr class="odd">
<td>tidymodels</td>
</tr>
<tr class="even">
<td>survey</td>
</tr>
<tr class="odd">
<td>olsrr</td>
</tr>
<tr class="even">
<td>car</td>
</tr>
<tr class="odd">
<td>prais</td>
</tr>
<tr class="even">
<td>gee</td>
</tr>
</tbody>
</table>
</section>
<section id="page-140-independencedependence-with-means" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="page-140-independencedependence-with-means"><span class="header-section-number">8.2</span> Page 140 Independence/Dependence with Means</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usethis) <span class="co"># use_github_file </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># read_csv()</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co"># clean_names() </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr) <span class="co"># skim()</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels) <span class="co">#tidy() glance()</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="obtain-data-and-save-it-to-your-computer" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="obtain-data-and-save-it-to-your-computer"><span class="header-section-number">8.2.1</span> Obtain data and save it to your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_github_file</span>(<span class="at">repo_spec =</span> <span class="st">"https://github.com/johnhoffmannVA/LinearRegression/blob/main/MultiLevel.csv"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_as =</span> <span class="st">"data_multilevel.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data-from-your-computer" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="load-data-from-your-computer"><span class="header-section-number">8.2.2</span> Load data from your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_multilevel <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data_multilevel.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-data" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="inspect-data"><span class="header-section-number">8.2.3</span> Inspect data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_multilevel <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 9,859
Columns: 14
$ idcomm       &lt;dbl&gt; 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 2…
$ id           &lt;dbl&gt; 10001, 10004, 10005, 10008, 10009, 10012, 10013, 10015, 1…
$ male         &lt;chr&gt; "female", "female", "male", "female", "male", "female", "…
$ white        &lt;chr&gt; "white", "white", "white", "white", "white", "white", "wh…
$ married      &lt;chr&gt; "no", "yes", "yes", "no", "yes", "no", "yes", "no", "yes"…
$ age          &lt;dbl&gt; 42, 68, 58, 37, 64, 69, 33, 74, 41, 47, 41, 56, 33, 71, 5…
$ educate      &lt;dbl&gt; 5, 3, 3, 5, 4, 3, 3, 6, 6, 3, 3, 4, 6, 3, 4, 3, 4, 7, 3, …
$ income       &lt;dbl&gt; 2, 4, 3, 2, 8, 3, 6, 3, 7, 2, 4, 4, 6, 7, 6, 8, 4, 4, 4, …
$ commlength   &lt;dbl&gt; 42, 50, 50, 5, 30, 69, 9, 30, 11, 8, 30, 5, 2, 71, 25, 2,…
$ commtrust    &lt;dbl&gt; 0.349, -0.434, -1.546, -0.707, -0.264, 0.465, -0.596, 0.5…
$ trust        &lt;chr&gt; "not_high", "not_high", "not_high", "not_high", "not_high…
$ pop2020      &lt;dbl&gt; 917, 917, 917, 917, 917, 917, 917, 917, 917, 917, 917, 91…
$ relighomog   &lt;dbl&gt; 0.277, 0.277, 0.277, 0.277, 0.277, 0.277, 0.277, 0.277, 0…
$ disadvantage &lt;dbl&gt; -1.219, -1.219, -1.219, -1.219, -1.219, -1.219, -1.219, -…</code></pre>
</div>
</div>
</section>
<section id="view-data" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="view-data"><span class="header-section-number">8.2.4</span> View data</h3>
<p>Remember you can always use the view() command in R to see the data in a spreadsheet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="specify-design" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="specify-design"><span class="header-section-number">8.2.5</span> Specify Design</h3>
<p>We indicate town is a grouping variable (idcomm which I think stands for id community).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>clus_multilevel <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>idcomm,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> data_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in svydesign.default(ids = ~idcomm, data = data_multilevel): No weights
or probabilities supplied, assuming equal probability</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(clus_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 - level Cluster Sampling design (with replacement)
With (99) clusters.
svydesign(ids = ~idcomm, data = data_multilevel)
Probabilities:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1       1       1       1       1       1 
Data variables:
 [1] "idcomm"       "id"           "male"         "white"        "married"     
 [6] "age"          "educate"      "income"       "commlength"   "commtrust"   
[11] "trust"        "pop2020"      "relighomog"   "disadvantage"</code></pre>
</div>
</div>
</section>
<section id="calculate-meanse" class="level3" data-number="8.2.6">
<h3 data-number="8.2.6" class="anchored" data-anchor-id="calculate-meanse"><span class="header-section-number">8.2.6</span> Calculate Mean/SE</h3>
<p>In the calculation we below we us the is.na() command. This provides a vector of TRUE/FALSE non-missing values. TRUE indicates missing. We using an exclamation mark in from to the INVERT the TRUE/FALSE. That means, TRUE indicates NOT missing after we using the exclamation mark. Then we use the sum() command to add up the TRUEs. Each TRUE counts as 1 so this provides us with a count of non-missing values. We could have used the n() command but this doesn’t know if there are missing values and can produce incorrect results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_multilevel <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(commlength)),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(commlength),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD=</span> <span class="fu">sd</span>(commlength),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">SE =</span> SD<span class="sc">/</span><span class="fu">sqrt</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     n     mean       SD        SE
1 9859 33.25885 22.44965 0.2260962</code></pre>
</div>
</div>
<p>Consider the SE calculation here. It is the usual one.</p>
<p><span class="math display">\[
SE = \frac{SD}{\sqrt{n}}= \frac{22.44965}{\sqrt{9859}} = 0.2260962
\]</span></p>
</section>
<section id="calculate-meanse-incorporting-cluster-dependence" class="level3" data-number="8.2.7">
<h3 data-number="8.2.7" class="anchored" data-anchor-id="calculate-meanse-incorporting-cluster-dependence"><span class="header-section-number">8.2.7</span> Calculate Mean/SE Incorporting Cluster Dependence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span>commlength,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">design =</span> clus_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             mean     SE
commlength 33.259 0.5297</code></pre>
</div>
</div>
<p>Notice how the SE is much larger when clustering is taken into account. When the clusters are taken into account it means that we realize that within a clusters each person does not provide information independent of the other people. So from a statistical perspective this makes the effective sample size smaller when calculating SE. In this data set the 9859 people (with dependence due to clusters) are equivalent to 1796.219 independent people - see the calculation below. Note though this is not the actual calculation “under the hood”, it is just a means of illustrating what we are compensating for when we take clusters into account. The lower effective sample size (due to a lack of independence) results in a larger Standard Error (0.5297 vs 0.2261).</p>
<p><span class="math display">\[
SE = \frac{SD}{\sqrt{n}}= \frac{22.44965}{\sqrt{1796.219}} = 0.5296999
\]</span></p>
</section>
</section>
<section id="page-142-independencedependence-with-regression" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="page-142-independencedependence-with-regression"><span class="header-section-number">8.3</span> Page 142 Independence/Dependence with Regression</h2>
<section id="regular-regression-no-adjustment" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="regular-regression-no-adjustment"><span class="header-section-number">8.3.1</span> Regular Regression No Adjustment</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>lm8_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> male <span class="sc">+</span> married, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm8_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2.9309727</td>
<td style="text-align: right;">0.0363492</td>
<td style="text-align: right;">80.63368</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">malemale</td>
<td style="text-align: right;">0.5187255</td>
<td style="text-align: right;">0.0394160</td>
<td style="text-align: right;">13.16028</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">marriedyes</td>
<td style="text-align: right;">1.7475797</td>
<td style="text-align: right;">0.0422214</td>
<td style="text-align: right;">41.39084</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm8_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
(Intercept) 2.8597208 3.0022247
malemale    0.4414621 0.5959889
marriedyes  1.6648171 1.8303423</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm8_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1810082</td>
<td style="text-align: right;">0.180842</td>
<td style="text-align: right;">1.908896</td>
<td style="text-align: right;">1089.154</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-20361.91</td>
<td style="text-align: right;">40731.81</td>
<td style="text-align: right;">40760.6</td>
<td style="text-align: right;">35914.12</td>
<td style="text-align: right;">9856</td>
<td style="text-align: right;">9859</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="dependence-adjusted-regression" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="dependence-adjusted-regression"><span class="header-section-number">8.3.2</span> Dependence Adjusted Regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>clus_multilevel <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>idcomm,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> data_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in svydesign.default(ids = ~idcomm, data = data_multilevel): No weights
or probabilities supplied, assuming equal probability</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(clus_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 - level Cluster Sampling design (with replacement)
With (99) clusters.
svydesign(ids = ~idcomm, data = data_multilevel)
Probabilities:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      1       1       1       1       1       1 
Data variables:
 [1] "idcomm"       "id"           "male"         "white"        "married"     
 [6] "age"          "educate"      "income"       "commlength"   "commtrust"   
[11] "trust"        "pop2020"      "relighomog"   "disadvantage"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lm8_2 <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(income <span class="sc">~</span> male <span class="sc">+</span> married, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">design =</span> clus_multilevel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm8_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2.9309727</td>
<td style="text-align: right;">0.0406152</td>
<td style="text-align: right;">72.16442</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">malemale</td>
<td style="text-align: right;">0.5187255</td>
<td style="text-align: right;">0.0420681</td>
<td style="text-align: right;">12.33060</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">marriedyes</td>
<td style="text-align: right;">1.7475797</td>
<td style="text-align: right;">0.0441621</td>
<td style="text-align: right;">39.57192</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm8_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %    97.5 %
(Intercept) 2.8503522 3.0115933
malemale    0.4352209 0.6022301
marriedyes  1.6599186 1.8352408</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm8_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">null.deviance</th>
<th style="text-align: right;">df.null</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">43851.62</td>
<td style="text-align: right;">9858</td>
<td style="text-align: right;">11183.24</td>
<td style="text-align: right;">35941.71</td>
<td style="text-align: right;">35914.12</td>
<td style="text-align: right;">96</td>
<td style="text-align: right;">9859</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="comparing-results" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="comparing-results"><span class="header-section-number">8.3.3</span> Comparing results</h3>
<p>In the two outputs below notice the standard error is higher in the Dependence Adjusted results. This follows the same principle as when we dealt with means: when dependence is taken into account the standard error is larger. This correspondingly affects p-values - making them larger (further from 0) but more accurate.</p>
<section id="regular-regression---see-se-for-weights" class="level4" data-number="8.3.3.1">
<h4 data-number="8.3.3.1" class="anchored" data-anchor-id="regular-regression---see-se-for-weights"><span class="header-section-number">8.3.3.1</span> Regular regression - see SE for weights</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm8_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2.9309727</td>
<td style="text-align: right;">0.0363492</td>
<td style="text-align: right;">80.63368</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">malemale</td>
<td style="text-align: right;">0.5187255</td>
<td style="text-align: right;">0.0394160</td>
<td style="text-align: right;">13.16028</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">marriedyes</td>
<td style="text-align: right;">1.7475797</td>
<td style="text-align: right;">0.0422214</td>
<td style="text-align: right;">41.39084</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="dependence-adjusted---see-se-for-weights" class="level4" data-number="8.3.3.2">
<h4 data-number="8.3.3.2" class="anchored" data-anchor-id="dependence-adjusted---see-se-for-weights"><span class="header-section-number">8.3.3.2</span> Dependence Adjusted - see SE for weights</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm8_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2.9309727</td>
<td style="text-align: right;">0.0406152</td>
<td style="text-align: right;">72.16442</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">malemale</td>
<td style="text-align: right;">0.5187255</td>
<td style="text-align: right;">0.0420681</td>
<td style="text-align: right;">12.33060</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">marriedyes</td>
<td style="text-align: right;">1.7475797</td>
<td style="text-align: right;">0.0441621</td>
<td style="text-align: right;">39.57192</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="page-145-serial-correlation" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="page-145-serial-correlation"><span class="header-section-number">8.4</span> Page 145 Serial Correlation</h2>
<section id="obtain-data-and-save-it-to-your-computer-1" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="obtain-data-and-save-it-to-your-computer-1"><span class="header-section-number">8.4.1</span> Obtain data and save it to your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_github_file</span>(<span class="at">repo_spec =</span> <span class="st">"https://github.com/johnhoffmannVA/LinearRegression/blob/main/Colombia2000_16.csv"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_as =</span> <span class="st">"columbia.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data-from-your-computer-1" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="load-data-from-your-computer-1"><span class="header-section-number">8.4.2</span> Load data from your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>columbia <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"columbia.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-data-1" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="inspect-data-1"><span class="header-section-number">8.4.3</span> Inspect data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>columbia <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 17
Columns: 9
$ index         &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17
$ year          &lt;dbl&gt; 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 20…
$ homicide_rate &lt;dbl&gt; 66.5, 68.6, 68.9, 53.8, 44.8, 39.6, 36.8, 34.7, 33.0, 33…
$ homicides     &lt;dbl&gt; 26540, 27840, 28387, 22526, 19036, 17086, 16119, 15423, …
$ population    &lt;dbl&gt; 39.64, 40.26, 40.88, 41.48, 42.08, 42.65, 43.20, 43.74, …
$ unemploy      &lt;dbl&gt; 20.52, 15.04, 15.63, 14.19, 13.72, 11.87, 11.51, 11.20, …
$ poverty       &lt;dbl&gt; 53.7, 60.5, 53.2, 50.9, 50.8, 46.7, 44.1, 43.4, 42.3, 41…
$ gni           &lt;dbl&gt; 2340, 2330, 2370, 2370, 2620, 2990, 3500, 4120, 4700, 51…
$ education     &lt;dbl&gt; 6.50, 6.50, 6.60, 6.65, 6.75, 6.00, 6.90, 7.00, 7.10, 7.…</code></pre>
</div>
</div>
</section>
<section id="view-data-1" class="level3" data-number="8.4.4">
<h3 data-number="8.4.4" class="anchored" data-anchor-id="view-data-1"><span class="header-section-number">8.4.4</span> View data</h3>
<p>Remember you can always use the view() command in R to see the data in a spreadsheet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(columbia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regular-regression" class="level3" data-number="8.4.5">
<h3 data-number="8.4.5" class="anchored" data-anchor-id="regular-regression"><span class="header-section-number">8.4.5</span> Regular Regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lm8_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(homicide_rate <span class="sc">~</span> poverty,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>columbia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm8_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-18.955563</td>
<td style="text-align: right;">7.1414543</td>
<td style="text-align: right;">-2.654300</td>
<td style="text-align: right;">0.0180357</td>
</tr>
<tr class="even">
<td style="text-align: left;">poverty</td>
<td style="text-align: right;">1.407943</td>
<td style="text-align: right;">0.1660531</td>
<td style="text-align: right;">8.478867</td>
<td style="text-align: right;">0.0000004</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm8_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %    97.5 %
(Intercept) -34.177213 -3.733914
poverty       1.054009  1.761876</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm8_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.8273703</td>
<td style="text-align: right;">0.8158617</td>
<td style="text-align: right;">6.479184</td>
<td style="text-align: right;">71.89119</td>
<td style="text-align: right;">4e-07</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-54.82418</td>
<td style="text-align: right;">115.6484</td>
<td style="text-align: right;">118.148</td>
<td style="text-align: right;">629.6975</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">17</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="check-autocorrelation-of-residuals" class="level4" data-number="8.4.5.1">
<h4 data-number="8.4.5.1" class="anchored" data-anchor-id="check-autocorrelation-of-residuals"><span class="header-section-number">8.4.5.1</span> Check Autocorrelation of Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Deleted studentized residual vs fitted values plot</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_stud_fit</span>(lm8_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="chapter8_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Obtain the residuals using the augment() command from the broom package. The residuals are in the .resid column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(lm8_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">homicide_rate</th>
<th style="text-align: right;">poverty</th>
<th style="text-align: right;">.fitted</th>
<th style="text-align: right;">.resid</th>
<th style="text-align: right;">.hat</th>
<th style="text-align: right;">.sigma</th>
<th style="text-align: right;">.cooksd</th>
<th style="text-align: right;">.std.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">66.5</td>
<td style="text-align: right;">53.7</td>
<td style="text-align: right;">56.65095</td>
<td style="text-align: right;">9.849052</td>
<td style="text-align: right;">0.1494618</td>
<td style="text-align: right;">6.068935</td>
<td style="text-align: right;">0.2387046</td>
<td style="text-align: right;">1.6482656</td>
</tr>
<tr class="even">
<td style="text-align: right;">68.6</td>
<td style="text-align: right;">60.5</td>
<td style="text-align: right;">66.22496</td>
<td style="text-align: right;">2.375043</td>
<td style="text-align: right;">0.2847689</td>
<td style="text-align: right;">6.664462</td>
<td style="text-align: right;">0.0374001</td>
<td style="text-align: right;">0.4334390</td>
</tr>
<tr class="odd">
<td style="text-align: right;">68.9</td>
<td style="text-align: right;">53.2</td>
<td style="text-align: right;">55.94698</td>
<td style="text-align: right;">12.953024</td>
<td style="text-align: right;">0.1419102</td>
<td style="text-align: right;">5.568849</td>
<td style="text-align: right;">0.3851410</td>
<td style="text-align: right;">2.1581640</td>
</tr>
<tr class="even">
<td style="text-align: right;">53.8</td>
<td style="text-align: right;">50.9</td>
<td style="text-align: right;">52.70871</td>
<td style="text-align: right;">1.091291</td>
<td style="text-align: right;">0.1114027</td>
<td style="text-align: right;">6.699452</td>
<td style="text-align: right;">0.0020012</td>
<td style="text-align: right;">0.1786767</td>
</tr>
<tr class="odd">
<td style="text-align: right;">44.8</td>
<td style="text-align: right;">50.8</td>
<td style="text-align: right;">52.56791</td>
<td style="text-align: right;">-7.767915</td>
<td style="text-align: right;">0.1102340</td>
<td style="text-align: right;">6.335170</td>
<td style="text-align: right;">0.1000696</td>
<td style="text-align: right;">-1.2710019</td>
</tr>
<tr class="even">
<td style="text-align: right;">39.6</td>
<td style="text-align: right;">46.7</td>
<td style="text-align: right;">46.79535</td>
<td style="text-align: right;">-7.195350</td>
<td style="text-align: right;">0.0736249</td>
<td style="text-align: right;">6.402063</td>
<td style="text-align: right;">0.0529035</td>
<td style="text-align: right;">-1.1538203</td>
</tr>
<tr class="odd">
<td style="text-align: right;">36.8</td>
<td style="text-align: right;">44.1</td>
<td style="text-align: right;">43.13470</td>
<td style="text-align: right;">-6.334700</td>
<td style="text-align: right;">0.0618514</td>
<td style="text-align: right;">6.474805</td>
<td style="text-align: right;">0.0335883</td>
<td style="text-align: right;">-1.0094153</td>
</tr>
<tr class="even">
<td style="text-align: right;">34.7</td>
<td style="text-align: right;">43.4</td>
<td style="text-align: right;">42.14914</td>
<td style="text-align: right;">-7.449140</td>
<td style="text-align: right;">0.0601989</td>
<td style="text-align: right;">6.384431</td>
<td style="text-align: right;">0.0450462</td>
<td style="text-align: right;">-1.1859540</td>
</tr>
<tr class="odd">
<td style="text-align: right;">33.0</td>
<td style="text-align: right;">42.3</td>
<td style="text-align: right;">40.60040</td>
<td style="text-align: right;">-7.600404</td>
<td style="text-align: right;">0.0589026</td>
<td style="text-align: right;">6.371341</td>
<td style="text-align: right;">0.0457581</td>
<td style="text-align: right;">-1.2092025</td>
</tr>
<tr class="even">
<td style="text-align: right;">33.7</td>
<td style="text-align: right;">41.1</td>
<td style="text-align: right;">38.91087</td>
<td style="text-align: right;">-5.210873</td>
<td style="text-align: right;">0.0593014</td>
<td style="text-align: right;">6.551077</td>
<td style="text-align: right;">0.0216727</td>
<td style="text-align: right;">-0.8292106</td>
</tr>
<tr class="odd">
<td style="text-align: right;">32.3</td>
<td style="text-align: right;">38.3</td>
<td style="text-align: right;">34.96863</td>
<td style="text-align: right;">-2.668634</td>
<td style="text-align: right;">0.0675883</td>
<td style="text-align: right;">6.665796</td>
<td style="text-align: right;">0.0065942</td>
<td style="text-align: right;">-0.4265449</td>
</tr>
<tr class="even">
<td style="text-align: right;">33.6</td>
<td style="text-align: right;">35.2</td>
<td style="text-align: right;">30.60401</td>
<td style="text-align: right;">2.995988</td>
<td style="text-align: right;">0.0887765</td>
<td style="text-align: right;">6.653930</td>
<td style="text-align: right;">0.0114303</td>
<td style="text-align: right;">0.4844035</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30.8</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right;">28.91448</td>
<td style="text-align: right;">1.885519</td>
<td style="text-align: right;">0.1003676</td>
<td style="text-align: right;">6.685516</td>
<td style="text-align: right;">0.0052512</td>
<td style="text-align: right;">0.3068160</td>
</tr>
<tr class="even">
<td style="text-align: right;">27.9</td>
<td style="text-align: right;">32.0</td>
<td style="text-align: right;">26.09860</td>
<td style="text-align: right;">1.801404</td>
<td style="text-align: right;">0.1238899</td>
<td style="text-align: right;">6.686840</td>
<td style="text-align: right;">0.0062384</td>
<td style="text-align: right;">0.2970376</td>
</tr>
<tr class="odd">
<td style="text-align: right;">26.5</td>
<td style="text-align: right;">29.8</td>
<td style="text-align: right;">23.00112</td>
<td style="text-align: right;">3.498877</td>
<td style="text-align: right;">0.1558335</td>
<td style="text-align: right;">6.628916</td>
<td style="text-align: right;">0.0318854</td>
<td style="text-align: right;">0.5877523</td>
</tr>
<tr class="even">
<td style="text-align: right;">25.5</td>
<td style="text-align: right;">28.7</td>
<td style="text-align: right;">21.45239</td>
<td style="text-align: right;">4.047614</td>
<td style="text-align: right;">0.1741896</td>
<td style="text-align: right;">6.600100</td>
<td style="text-align: right;">0.0498413</td>
<td style="text-align: right;">0.6874460</td>
</tr>
<tr class="odd">
<td style="text-align: right;">24.9</td>
<td style="text-align: right;">28.5</td>
<td style="text-align: right;">21.17080</td>
<td style="text-align: right;">3.729203</td>
<td style="text-align: right;">0.1776978</td>
<td style="text-align: right;">6.615918</td>
<td style="text-align: right;">0.0435292</td>
<td style="text-align: right;">0.6347167</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can calculate the Durbin-Watson test statistic with the formula below. But that notation can be hard to understand.</p>
<p><span class="math display">\[
d = \frac{\sum\limits_{ti=2}^n(\epsilon_{ti}-\epsilon_{ti-1})^2}{\sum\limits_{ti=1}^n\epsilon_{ti}^2}
\]</span></p>
<p>Let’s consider the numerator first. Look the values in the .resid column and see how they are used.</p>
<p><span class="math display">\[
\begin{aligned}
\sum\limits_{ti=2}^n(\epsilon_{ti}-\epsilon_{ti-1})^2 &amp;= (2.375043 - 9.849052)^2 + (12.953023-2.375043)^2 + (1.091291-12.953023)^2 + ... + (3.729203 - 4.047614) ^2\\
&amp;= 438.059
\end{aligned}
\]</span></p>
<p>Now the denominator:</p>
<p><span class="math display">\[
\begin{aligned}
\sum\limits_{ti=1}^n\epsilon_{ti}^2 &amp;= 9.849052^2 +  2.375043^2 + 12.953023^2 + ... + 3.729203^2\\
&amp;= 629.6975
\end{aligned}
\]</span></p>
<p>We combine them to get the final Durbin-Watson statistic:</p>
<p><span class="math display">\[
d = \frac{\sum\limits_{ti=2}^n(\epsilon_{ti}-\epsilon_{ti-1})^2}{\sum\limits_{ti=1}^n\epsilon_{ti}^2} = \frac{438.059}{629.6975} = 0.6956658
\]</span></p>
<p>Compare this to the output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(lm8_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1       0.5641004     0.6956658       0
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
<p>This output also contains an autocorrelation value. It is calculated using the formula below. Not this is the formula used by R. The formula in the text book on p.&nbsp;149 Footnote 10 is not used by the R durbinWatsonTest() command.</p>
<p><span class="math display">\[
r = \frac{\sum\limits_{ti=2}^n\epsilon_{ti}\epsilon_{ti-1}}{\sum\limits_{ti=1}^n\epsilon_{ti}^2} = 0.5641004
\]</span></p>
<p>Autocorrelation of residuals is a way of determining if the independence of rows assumption for regression is true. The autocorrelation of residuals is a way of examining if the residuals at one time are related to the residuals at the next time. If the two are unrelated then the rows are independent - and the regression assumption is true. Alternatively, if the residuals at one time are related to residuals at the next time - then the rows are dependent - and the regression assumption is violated.</p>
<p>Consider the table below. The first column on the left is the original residuals. The second column on the right is the residuals shifted by one spot (i.e., a lag of 1 time period). Autocorrelation of residuals checks to see if these two columns are correlated. If the residuals are correlated (i.e., the columns below are correlated) this indicates the errors at one time are related to the errors at another time. That is, the errors on one row are related to the errors on another row. If this is true, the rows are not independent of each other and the regression assumption is violated.</p>
<p>The textbook autcorrelation formula would give you the actual correlation between the two columns below which is .62. For technical reasons R actually uses a slightly different calculation formula, above, which is conceptually similar, but produces a value of 0.56.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">residuals</th>
<th style="text-align: right;">shifted_residuals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">9.849052</td>
<td style="text-align: right;">2.375043</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.375043</td>
<td style="text-align: right;">12.953024</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12.953024</td>
<td style="text-align: right;">1.091291</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.091291</td>
<td style="text-align: right;">-7.767915</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-7.767915</td>
<td style="text-align: right;">-7.195350</td>
</tr>
<tr class="even">
<td style="text-align: right;">-7.195350</td>
<td style="text-align: right;">-6.334700</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-6.334700</td>
<td style="text-align: right;">-7.449140</td>
</tr>
<tr class="even">
<td style="text-align: right;">-7.449140</td>
<td style="text-align: right;">-7.600404</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-7.600404</td>
<td style="text-align: right;">-5.210873</td>
</tr>
<tr class="even">
<td style="text-align: right;">-5.210873</td>
<td style="text-align: right;">-2.668634</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.668634</td>
<td style="text-align: right;">2.995988</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.995988</td>
<td style="text-align: right;">1.885519</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.885519</td>
<td style="text-align: right;">1.801404</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.801404</td>
<td style="text-align: right;">3.498877</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.498877</td>
<td style="text-align: right;">4.047614</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.047614</td>
<td style="text-align: right;">3.729203</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="page-150-corrections-for-dependence" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="page-150-corrections-for-dependence"><span class="header-section-number">8.5</span> Page 150 Corrections for dependence</h2>
<section id="regular-regression-1" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="regular-regression-1"><span class="header-section-number">8.5.1</span> Regular regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>lm8_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(homicide_rate <span class="sc">~</span> poverty,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> columbia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm8_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-18.955563</td>
<td style="text-align: right;">7.1414543</td>
<td style="text-align: right;">-2.654300</td>
<td style="text-align: right;">0.0180357</td>
</tr>
<tr class="even">
<td style="text-align: left;">poverty</td>
<td style="text-align: right;">1.407943</td>
<td style="text-align: right;">0.1660531</td>
<td style="text-align: right;">8.478867</td>
<td style="text-align: right;">0.0000004</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm8_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %    97.5 %
(Intercept) -34.177213 -3.733914
poverty       1.054009  1.761876</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm8_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.8273703</td>
<td style="text-align: right;">0.8158617</td>
<td style="text-align: right;">6.479184</td>
<td style="text-align: right;">71.89119</td>
<td style="text-align: right;">4e-07</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-54.82418</td>
<td style="text-align: right;">115.6484</td>
<td style="text-align: right;">118.148</td>
<td style="text-align: right;">629.6975</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">17</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="page-prais-winsten-regression-model" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="page-prais-winsten-regression-model"><span class="header-section-number">8.5.2</span> Page Prais-Winsten Regression Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prais)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sandwich</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pcse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pcse'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:sandwich':

    vcovPC</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>lm8_5 <span class="ot">&lt;-</span> <span class="fu">prais_winsten</span>(homicide_rate <span class="sc">~</span> poverty,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> columbia,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">index =</span> <span class="st">"index"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration 0: rho = 0
Iteration 1: rho = 0.5768
Iteration 2: rho = 0.6171
Iteration 3: rho = 0.6288
Iteration 4: rho = 0.6328
Iteration 5: rho = 0.6342
Iteration 6: rho = 0.6348
Iteration 7: rho = 0.635
Iteration 8: rho = 0.635
Iteration 9: rho = 0.6351
Iteration 10: rho = 0.6351
Iteration 11: rho = 0.6351
Iteration 12: rho = 0.6351
Iteration 13: rho = 0.6351</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm8_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
prais_winsten(formula = homicide_rate ~ poverty, data = columbia, 
    index = "index")

Residuals:
    Min      1Q  Median      3Q     Max 
-8.6640 -7.0686 -0.6986  0.6317 13.8862 

AR(1) coefficient rho after 13 iterations: 0.6351

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -10.1427    11.1090  -0.913 0.375674    
poverty       1.2247     0.2558   4.789 0.000239 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.976 on 15 degrees of freedom
Multiple R-squared:  0.8019,    Adjusted R-squared:  0.7887 
F-statistic: 60.73 on 1 and 15 DF,  p-value: 1.187e-06

Durbin-Watson statistic (original): 0.6957 
Durbin-Watson statistic (transformed): 1.873</code></pre>
</div>
</div>
</section>
</section>
<section id="page-153-gee-for-longitudinal-data" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="page-153-gee-for-longitudinal-data"><span class="header-section-number">8.6</span> Page 153 GEE for Longitudinal Data</h2>
<section id="obtain-data-and-save-it-to-your-computer-2" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="obtain-data-and-save-it-to-your-computer-2"><span class="header-section-number">8.6.1</span> Obtain data and save it to your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_github_file</span>(<span class="at">repo_spec =</span> <span class="st">"https://github.com/johnhoffmannVA/LinearRegression/blob/main/Esteem.csv"</span>,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_as =</span> <span class="st">"data_esteem.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data-from-your-computer-2" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="load-data-from-your-computer-2"><span class="header-section-number">8.6.2</span> Load data from your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data_esteem <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data_esteem.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-data-2" class="level3" data-number="8.6.3">
<h3 data-number="8.6.3" class="anchored" data-anchor-id="inspect-data-2"><span class="header-section-number">8.6.3</span> Inspect data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>data_esteem <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,250
Columns: 14
$ newid      &lt;dbl&gt; 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 23,…
$ year       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,…
$ age        &lt;dbl&gt; 11, 12, 13, 14, 15, 16, 17, 14, 15, 16, 17, 18, 19, 20, 14,…
$ male       &lt;chr&gt; "male", "male", "male", "male", "male", "male", "male", "ma…
$ income     &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 3, 3, 3, 3, 3, 3,…
$ nonwhite   &lt;chr&gt; "white", "white", "white", "white", "white", "white", "whit…
$ fstruct    &lt;chr&gt; "yes", "yes", "yes", "yes", "yes", "yes", "yes", "yes", "ye…
$ stress     &lt;dbl&gt; -6.84, -6.14, -3.42, -5.64, -6.28, -1.27, -0.73, -6.84, -6.…
$ cohesion   &lt;dbl&gt; 6.88, 6.15, -9.28, -7.41, -13.57, -19.26, -21.08, -3.21, -2…
$ sattach    &lt;dbl&gt; -6.34, -1.47, -4.35, -3.46, -8.48, -12.83, 0.14, -5.22, -10…
$ depress    &lt;dbl&gt; -9.47, 17.51, 13.18, -1.03, -6.63, -8.76, 12.68, 0.08, -5.3…
$ esteem     &lt;dbl&gt; -0.56, -7.19, -11.92, -6.22, -1.83, -3.54, -4.96, 1.33, 2.0…
$ mastery    &lt;dbl&gt; 2.81, 1.91, -3.57, -1.10, -4.64, -3.99, 3.10, -2.29, -1.57,…
$ bi_depress &lt;chr&gt; "below", "above", "above", "below", "below", "below", "abov…</code></pre>
</div>
</div>
</section>
<section id="view-data-2" class="level3" data-number="8.6.4">
<h3 data-number="8.6.4" class="anchored" data-anchor-id="view-data-2"><span class="header-section-number">8.6.4</span> View data</h3>
<p>Remember you can always use the view() command in R to see the data in a spreadsheet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_esteem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_esteem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  newid  year   age male  income nonwhite fstruct stress cohesion sattach
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1    13     1    11 male       5 white    yes      -6.84     6.88   -6.34
2    13     2    12 male       5 white    yes      -6.14     6.15   -1.47
3    13     3    13 male       5 white    yes      -3.42    -9.28   -4.35
4    13     4    14 male       5 white    yes      -5.64    -7.41   -3.46
5    13     5    15 male       5 white    yes      -6.28   -13.6    -8.48
6    13     6    16 male       5 white    yes      -1.27   -19.3   -12.8 
# ℹ 4 more variables: depress &lt;dbl&gt;, esteem &lt;dbl&gt;, mastery &lt;dbl&gt;,
#   bi_depress &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="just-essential-variables" class="level3" data-number="8.6.5">
<h3 data-number="8.6.5" class="anchored" data-anchor-id="just-essential-variables"><span class="header-section-number">8.6.5</span> Just essential variables</h3>
<p>To make things easier to follow later. We’ll select() just the columns we need:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>data_esteem_working <span class="ot">&lt;-</span> data_esteem <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, esteem, cohesion, stress)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>data_esteem_working <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,250
Columns: 4
$ newid    &lt;dbl&gt; 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 23, 2…
$ esteem   &lt;dbl&gt; -0.56, -7.19, -11.92, -6.22, -1.83, -3.54, -4.96, 1.33, 2.03,…
$ cohesion &lt;dbl&gt; 6.88, 6.15, -9.28, -7.41, -13.57, -19.26, -21.08, -3.21, -2.7…
$ stress   &lt;dbl&gt; -6.84, -6.14, -3.42, -5.64, -6.28, -1.27, -0.73, -6.84, -6.14…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_esteem_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see the first 15 rows of this new data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_esteem_working, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">newid</th>
<th style="text-align: right;">esteem</th>
<th style="text-align: right;">cohesion</th>
<th style="text-align: right;">stress</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">6.88</td>
<td style="text-align: right;">-6.84</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-7.19</td>
<td style="text-align: right;">6.15</td>
<td style="text-align: right;">-6.14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-11.92</td>
<td style="text-align: right;">-9.28</td>
<td style="text-align: right;">-3.42</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-6.22</td>
<td style="text-align: right;">-7.41</td>
<td style="text-align: right;">-5.64</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-1.83</td>
<td style="text-align: right;">-13.57</td>
<td style="text-align: right;">-6.28</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-3.54</td>
<td style="text-align: right;">-19.26</td>
<td style="text-align: right;">-1.27</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-4.96</td>
<td style="text-align: right;">-21.08</td>
<td style="text-align: right;">-0.73</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">-3.21</td>
<td style="text-align: right;">-6.84</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">-2.72</td>
<td style="text-align: right;">-6.14</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">8.89</td>
<td style="text-align: right;">-10.88</td>
<td style="text-align: right;">-3.42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">9.41</td>
<td style="text-align: right;">-9.22</td>
<td style="text-align: right;">-5.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">9.14</td>
<td style="text-align: right;">-7.44</td>
<td style="text-align: right;">-6.28</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">-6.33</td>
<td style="text-align: right;">-12.74</td>
<td style="text-align: right;">-4.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">-6.46</td>
<td style="text-align: right;">-11.02</td>
<td style="text-align: right;">-3.53</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td style="text-align: right;">-6.93</td>
<td style="text-align: right;">-14.63</td>
<td style="text-align: right;">-4.47</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="regular-regression-2" class="level3" data-number="8.6.6">
<h3 data-number="8.6.6" class="anchored" data-anchor-id="regular-regression-2"><span class="header-section-number">8.6.6</span> Regular Regression</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>lm8_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(esteem <span class="sc">~</span> cohesion <span class="sc">+</span> stress,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> data_esteem_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm8_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0000029</td>
<td style="text-align: right;">0.0870514</td>
<td style="text-align: right;">0.0000332</td>
<td style="text-align: right;">0.9999735</td>
</tr>
<tr class="even">
<td style="text-align: left;">cohesion</td>
<td style="text-align: right;">0.2541432</td>
<td style="text-align: right;">0.0087651</td>
<td style="text-align: right;">28.9948569</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">stress</td>
<td style="text-align: right;">-0.1493022</td>
<td style="text-align: right;">0.0163233</td>
<td style="text-align: right;">-9.1465813</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm8_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %     97.5 %
(Intercept) -0.1706540  0.1706598
cohesion     0.2369599  0.2713264
stress      -0.1813027 -0.1173018</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm8_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">r.squared</th>
<th style="text-align: right;">adj.r.squared</th>
<th style="text-align: right;">sigma</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">logLik</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">deviance</th>
<th style="text-align: right;">df.residual</th>
<th style="text-align: right;">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1703517</td>
<td style="text-align: right;">0.1700355</td>
<td style="text-align: right;">6.307471</td>
<td style="text-align: right;">538.6834</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-17117.03</td>
<td style="text-align: right;">34242.07</td>
<td style="text-align: right;">34268.33</td>
<td style="text-align: right;">208747.7</td>
<td style="text-align: right;">5247</td>
<td style="text-align: right;">5250</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="page-154-gee-regression-ar1-pattern" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="page-154-gee-regression-ar1-pattern"><span class="header-section-number">8.7</span> Page 154 GEE Regression AR(1) Pattern</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gee)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>lm8_7 <span class="ot">&lt;-</span> <span class="fu">gee</span>(esteem <span class="sc">~</span> cohesion <span class="sc">+</span> stress,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> newid,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> data_esteem_working,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">corstr =</span> <span class="st">"AR-M"</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">Mv =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>running glm to get initial regression estimate</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)      cohesion        stress 
 2.893874e-06  2.541432e-01 -1.493022e-01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm8_7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     AR-M , M = 1 

Call:
gee(formula = esteem ~ cohesion + stress, id = newid, data = data_esteem_working, 
    corstr = "AR-M", Mv = 1)

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-37.895653  -4.201059   0.689138   4.918345  15.317508 


Coefficients:
                 Estimate  Naive S.E.       Naive z Robust S.E.     Robust z
(Intercept)  0.0000759361 0.144336853  0.0005261033  0.16303660  0.000465761
cohesion     0.2019027487 0.009271432 21.7768669671  0.01211667 16.663215493
stress      -0.0710920935 0.015016134 -4.7343807014  0.01691523 -4.202845600

Estimated Scale Parameter:  40.339
Number of Iterations:  4

Working Correlation
           [,1]       [,2]      [,3]      [,4]      [,5]       [,6]       [,7]
[1,] 1.00000000 0.58275393 0.3396021 0.1979045 0.1153296 0.06720879 0.03916618
[2,] 0.58275393 1.00000000 0.5827539 0.3396021 0.1979045 0.11532961 0.06720879
[3,] 0.33960214 0.58275393 1.0000000 0.5827539 0.3396021 0.19790448 0.11532961
[4,] 0.19790448 0.33960214 0.5827539 1.0000000 0.5827539 0.33960214 0.19790448
[5,] 0.11532961 0.19790448 0.3396021 0.5827539 1.0000000 0.58275393 0.33960214
[6,] 0.06720879 0.11532961 0.1979045 0.3396021 0.5827539 1.00000000 0.58275393
[7,] 0.03916618 0.06720879 0.1153296 0.1979045 0.3396021 0.58275393 1.00000000</code></pre>
</div>
</div>
</section>
<section id="page-155-gee-regression-unstructured-pattern" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="page-155-gee-regression-unstructured-pattern"><span class="header-section-number">8.8</span> Page 155 GEE Regression Unstructured Pattern</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>lm8_8 <span class="ot">&lt;-</span> <span class="fu">gee</span>(esteem <span class="sc">~</span> cohesion <span class="sc">+</span> stress,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> newid,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> data_esteem_working,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">corstr =</span> <span class="st">"unstructured"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>running glm to get initial regression estimate</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)      cohesion        stress 
 2.893874e-06  2.541432e-01 -1.493022e-01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm8_8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Unstructured 

Call:
gee(formula = esteem ~ cohesion + stress, id = newid, data = data_esteem_working, 
    corstr = "unstructured")

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-37.8642477  -4.1993354   0.6795163   4.9434080  15.1961802 


Coefficients:
                 Estimate  Naive S.E.       Naive z Robust S.E.      Robust z
(Intercept)  5.116826e-06 0.163405894  3.131359e-05  0.16073825  3.183328e-05
cohesion     1.969405e-01 0.009046301  2.177027e+01  0.01216873  1.618414e+01
stress      -6.733487e-02 0.014656940 -4.594060e+00  0.01675165 -4.019597e+00

Estimated Scale Parameter:  40.4264
Number of Iterations:  5

Working Correlation
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 1.0000000 0.4196993 0.3623088 0.3109070 0.2647337 0.2320768 0.2448309
[2,] 0.4196993 1.0000000 0.5514433 0.5118622 0.3657062 0.3415669 0.3169120
[3,] 0.3623088 0.5514433 1.0000000 0.5903386 0.3967422 0.3780522 0.3625584
[4,] 0.3109070 0.5118622 0.5903386 1.0000000 0.5845708 0.4775849 0.4393025
[5,] 0.2647337 0.3657062 0.3967422 0.5845708 1.0000000 0.6950766 0.6193434
[6,] 0.2320768 0.3415669 0.3780522 0.4775849 0.6950766 1.0000000 0.6639399
[7,] 0.2448309 0.3169120 0.3625584 0.4393025 0.6193434 0.6639399 1.0000000</code></pre>
</div>
</div>
</section>
<section id="page-157-lagged-regression" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="page-157-lagged-regression"><span class="header-section-number">8.9</span> Page 157 Lagged Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a lag versions of stress and cohesion</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>data_esteem_working <span class="ot">&lt;-</span> data_esteem_working <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(newid) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stress_lag =</span> <span class="fu">lag</span>(stress, <span class="at">order_by =</span> newid)) <span class="sc">%&gt;%</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cohesion_lag =</span> <span class="fu">lag</span>(cohesion, <span class="at">order_by =</span> newid)) <span class="sc">%&gt;%</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now reorder the columns to it’s easer to see what happened. We start by gettting all the column names. Then selecting them in a desirable order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(data_esteem_working))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "newid"        "esteem"       "cohesion"     "stress"       "stress_lag"  
[6] "cohesion_lag"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>data_esteem_working <span class="ot">&lt;-</span> data_esteem_working <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(newid, esteem, stress, stress_lag, cohesion, cohesion_lag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check out the data. See that we have a lagged version of stress and cohesion for each person.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_esteem_working)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see the first 15 rows. Remember newid indicates the scores for each person.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_esteem_working, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">newid</th>
<th style="text-align: right;">esteem</th>
<th style="text-align: right;">stress</th>
<th style="text-align: right;">stress_lag</th>
<th style="text-align: right;">cohesion</th>
<th style="text-align: right;">cohesion_lag</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">-6.84</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">6.88</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-7.19</td>
<td style="text-align: right;">-6.14</td>
<td style="text-align: right;">-6.84</td>
<td style="text-align: right;">6.15</td>
<td style="text-align: right;">6.88</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-11.92</td>
<td style="text-align: right;">-3.42</td>
<td style="text-align: right;">-6.14</td>
<td style="text-align: right;">-9.28</td>
<td style="text-align: right;">6.15</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-6.22</td>
<td style="text-align: right;">-5.64</td>
<td style="text-align: right;">-3.42</td>
<td style="text-align: right;">-7.41</td>
<td style="text-align: right;">-9.28</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-1.83</td>
<td style="text-align: right;">-6.28</td>
<td style="text-align: right;">-5.64</td>
<td style="text-align: right;">-13.57</td>
<td style="text-align: right;">-7.41</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-3.54</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">-6.28</td>
<td style="text-align: right;">-19.26</td>
<td style="text-align: right;">-13.57</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">-4.96</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">-1.27</td>
<td style="text-align: right;">-21.08</td>
<td style="text-align: right;">-19.26</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">-6.84</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-3.21</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">-6.14</td>
<td style="text-align: right;">-6.84</td>
<td style="text-align: right;">-2.72</td>
<td style="text-align: right;">-3.21</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">8.89</td>
<td style="text-align: right;">-3.42</td>
<td style="text-align: right;">-6.14</td>
<td style="text-align: right;">-10.88</td>
<td style="text-align: right;">-2.72</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">9.41</td>
<td style="text-align: right;">-5.64</td>
<td style="text-align: right;">-3.42</td>
<td style="text-align: right;">-9.22</td>
<td style="text-align: right;">-10.88</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">9.14</td>
<td style="text-align: right;">-6.28</td>
<td style="text-align: right;">-5.64</td>
<td style="text-align: right;">-7.44</td>
<td style="text-align: right;">-9.22</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">-6.33</td>
<td style="text-align: right;">-4.04</td>
<td style="text-align: right;">-6.28</td>
<td style="text-align: right;">-12.74</td>
<td style="text-align: right;">-7.44</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">-6.46</td>
<td style="text-align: right;">-3.53</td>
<td style="text-align: right;">-4.04</td>
<td style="text-align: right;">-11.02</td>
<td style="text-align: right;">-12.74</td>
</tr>
<tr class="odd">
<td style="text-align: right;">23</td>
<td style="text-align: right;">-6.93</td>
<td style="text-align: right;">-4.47</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">-14.63</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="regression-with-lagged-scores" class="level3" data-number="8.9.1">
<h3 data-number="8.9.1" class="anchored" data-anchor-id="regression-with-lagged-scores"><span class="header-section-number">8.9.1</span> Regression with lagged scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>lm8_9 <span class="ot">&lt;-</span> <span class="fu">gee</span>(esteem <span class="sc">~</span> cohesion_lag <span class="sc">+</span> stress_lag,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">id =</span> newid,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> data_esteem_working,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">corstr =</span> <span class="st">"unstructured"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>running glm to get initial regression estimate</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)  cohesion_lag    stress_lag 
-0.0000548957  0.2108613566 -0.1200494250 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm8_9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Unstructured 

Call:
gee(formula = esteem ~ cohesion_lag + stress_lag, id = newid, 
    data = data_esteem_working, corstr = "unstructured")

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-36.6340374  -4.7280288   0.8665372   5.6560904  11.8224922 


Coefficients:
                  Estimate Naive S.E.       Naive z Robust S.E.      Robust z
(Intercept)  -0.0001479426 0.18753982 -0.0007888596  0.18652032 -0.0007931715
cohesion_lag  0.0739829966 0.01045740  7.0747034937  0.01165273  6.3489849902
stress_lag   -0.0319850214 0.01671445 -1.9136148001  0.01735733 -1.8427387657

Estimated Scale Parameter:  46.82793
Number of Iterations:  5

Working Correlation
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]
[1,] 1.0000000 0.5733183 0.5312270 0.3652688 0.3458681 0.3245191
[2,] 0.5733183 1.0000000 0.6126773 0.4022154 0.3751523 0.3863323
[3,] 0.5312270 0.6126773 1.0000000 0.5495194 0.4757588 0.4554248
[4,] 0.3652688 0.4022154 0.5495194 1.0000000 0.6549964 0.5889848
[5,] 0.3458681 0.3751523 0.4757588 0.6549964 1.0000000 0.6389512
[6,] 0.3245191 0.3863323 0.4554248 0.5889848 0.6389512 1.0000000</code></pre>
</div>
</div>
</section>
</section>
<section id="page-162-chapter-exercises" class="level2" data-number="8.10">
<h2 data-number="8.10" class="anchored" data-anchor-id="page-162-chapter-exercises"><span class="header-section-number">8.10</span> Page 162 Chapter Exercises</h2>
<section id="obtain-data-and-save-it-to-your-computer-3" class="level3" data-number="8.10.1">
<h3 data-number="8.10.1" class="anchored" data-anchor-id="obtain-data-and-save-it-to-your-computer-3"><span class="header-section-number">8.10.1</span> Obtain data and save it to your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_github_file</span>(<span class="at">repo_spec =</span> <span class="st">"https://github.com/johnhoffmannVA/LinearRegression/blob/main/USCounties2010.csv"</span>,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_as =</span> <span class="st">"data_uscounties.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data-from-your-computer-3" class="level3" data-number="8.10.2">
<h3 data-number="8.10.2" class="anchored" data-anchor-id="load-data-from-your-computer-3"><span class="header-section-number">8.10.2</span> Load data from your computer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>data_counties <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data_uscounties.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="inspect-data-3" class="level3" data-number="8.10.3">
<h3 data-number="8.10.3" class="anchored" data-anchor-id="inspect-data-3"><span class="header-section-number">8.10.3</span> Inspect data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>data_counties <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,257
Columns: 12
$ state                &lt;chr&gt; "Alabama", "Alabama", "Alabama", "Alabama", "Alab…
$ state_code           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ county               &lt;chr&gt; "Autauga", "Baldwin", "Barbour", "Bibb", "Blount"…
$ county_code          &lt;dbl&gt; 1.01, 2.01, 3.01, 4.01, 5.01, 6.01, 7.01, 8.01, 9…
$ binge_drink          &lt;dbl&gt; 16, 20, 11, 13, 5, 5, 9, 13, 13, 13, 10, 8, 14, 7…
$ teen_births          &lt;dbl&gt; 51, 50, 74, 59, 51, 90, 66, 58, 70, 62, 61, 53, 4…
$ primary_care         &lt;dbl&gt; 68, 121, 57, 42, 36, 46, 55, 105, 67, 45, 42, 64,…
$ per_hs_grads         &lt;dbl&gt; 85, 73, 64, 67, 75, 58, 76, 72, 61, 67, 73, 68, 7…
$ per_single_parent_hh &lt;dbl&gt; 30, 29, 52, 35, 25, 64, 50, 39, 46, 26, 30, 37, 4…
$ violent_crime        &lt;dbl&gt; 291, 242, 190, 220, 143, 473, 433, 1006, 540, 156…
$ unhealthy_foods      &lt;dbl&gt; 21, 1, 5, 35, 29, 16, 3, 19, 1, 0, 31, 11, 6, 1, …
$ per_fast_food        &lt;dbl&gt; 47, 36, 64, 54, 56, 67, 47, 59, 54, 62, 58, 36, 6…</code></pre>
</div>
</div>
</section>
<section id="view-data-3" class="level3" data-number="8.10.4">
<h3 data-number="8.10.4" class="anchored" data-anchor-id="view-data-3"><span class="header-section-number">8.10.4</span> View data</h3>
<p>Remember you can always use the view() command in R to see the data in a spreadsheet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_counties)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter7.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Indicator Variables</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>